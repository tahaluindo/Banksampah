const getSampahMasuk=async()=>{let a=await httpRequestGet(`${APIURL}/transaksi/sampahmasuk`);if(200===a.status){let e=a.data.data;for(const a in e)$(`#sampah-${a.replace(/\s/g,"-")}`).html(parseFloat(e[a].total).toFixed(1)+" Kg")}};getSampahMasuk();const openModalSampahMasuk=async a=>{$("#modalDetailSampah .modal-title").html(`kategori ${a}`),$("#detil-sampah-spinner").removeClass("d-none"),$("#detil-sampah-notfound").addClass("d-none"),$("#modalDetailSampah #table-jenis-wraper").html("");let e=await httpRequestGet(`${APIURL}/transaksi/sampahmasuk?kategori=${a}`);if($("#detil-sampah-spinner").addClass("d-none"),404===e.status)$("#detil-sampah-notfound").removeClass("d-none");else if(200===e.status){let a="",t=e.data.data;t.forEach((e,t)=>{a+=`<tr class="text-center">\n                <th scope="row">${++t}</th>\n                <td>${e.jenis}</td>\n                <td>${parseFloat(e.jumlah_kg).toFixed(2)} kg</td>\n            </tr>`}),$("#modalDetailSampah #table-jenis-wraper").html(`<table class="table table-striped">\n            <thead>\n                <tr class="text-center">\n                    <th scope="col">#</th>\n                    <th scope="col">Jenis sampah</th>\n                    <th scope="col">Jumlah</th>\n                </tr>\n            </thead>\n            <tbody>\n                ${a}\n            </tbody>\n        </table>`)}},getSaldoNasabah=async()=>{let a=await httpRequestGet(`${APIURL}/transaksi/getsaldo`);if(200===a.status){let e=a.data.data;null!=e.saldo_bank&&$("#saldo-uang-bsbl").html(modifUang(e.saldo_bank.toString())),null!=e.saldo_nasabah.uang&&$("#saldo-uang-nasabah").html(modifUang(e.saldo_nasabah.uang.toString())),null!=e.saldo_nasabah.emas&&$("#saldo-emas").html(parseFloat(e.saldo_nasabah.emas).toFixed(4))}};getSaldoNasabah();const getTotalAkun=async()=>{let a=await httpRequestGet(`${APIURL}/admin/totalakun`);if(200===a.status){let e=a.data.data;$("#jml-nasabah").html(modifUang(e.jml_nasabah)),$("#jml-admin").html(modifUang(e.jml_admin))}};getTotalAkun();let arrayWilayah=[];const getAllWilayah=async()=>{let a=await httpRequestGet(`${APIURL}/nasabah/wilayah`),e=[],t='<option value="">-- pilih provinsi --</option>';200===a.status&&(arrayWilayah=a.data.data,arrayWilayah.forEach(a=>{e.includes(a.provinsi)||(e.push(a.provinsi),t+=`<option value="${a.provinsi}" data-provinsi="${a.provinsi}">${a.provinsi}</option>`)})),$("#formFilterGrafikSetor select[name=provinsi]").html(t)};getAllWilayah(),$("#formFilterGrafikSetor select[name=provinsi]").on("change",function(){let a=[],e='<option value="">-- pilih kota --</option>';""!=$(this).val()?($("#formFilterGrafikSetor select[name=kota]").removeAttr("disabled"),arrayWilayah.forEach(t=>{t.provinsi==$(this).val()&&(a.includes(t.kota)||(a.push(t.kota),e+=`<option value="${t.kota}">${t.kota}</option>`))}),$("#formFilterGrafikSetor select[name=kota]").html(e)):$("#formFilterGrafikSetor select[name=kota]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kota]").val(""),$("#formFilterGrafikSetor select[name=kecamatan]").val(""),$("#formFilterGrafikSetor select[name=kecamatan]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kelurahan]").val(""),$("#formFilterGrafikSetor select[name=kelurahan]").attr("disabled",!0)}),$("#formFilterGrafikSetor select[name=kota]").on("change",function(){let a=[],e='<option value="">-- pilih kecamatan --</option>';""!=$(this).val()?($("#formFilterGrafikSetor select[name=kecamatan]").removeAttr("disabled"),arrayWilayah.forEach(t=>{t.kota==$(this).val()&&(a.includes(t.kecamatan)||(a.push(t.kecamatan),e+=`<option value="${t.kecamatan}">${t.kecamatan}</option>`))}),$("#formFilterGrafikSetor select[name=kecamatan]").html(e)):$("#formFilterGrafikSetor select[name=kecamatan]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kecamatan]").val(""),$("#formFilterGrafikSetor select[name=kelurahan]").val(""),$("#formFilterGrafikSetor select[name=kelurahan]").attr("disabled",!0)}),$("#formFilterGrafikSetor select[name=kecamatan]").on("change",function(){let a=[],e='<option value="">-- pilih kelurahan --</option>';""!=$(this).val()?($("#formFilterGrafikSetor select[name=kelurahan]").removeAttr("disabled"),arrayWilayah.forEach(t=>{t.kecamatan==$(this).val()&&(a.includes(t.kelurahan)||(a.push(t.kelurahan),e+=`<option value="${t.kelurahan}">${t.kelurahan}</option>`))}),$("#formFilterGrafikSetor select[name=kelurahan]").html(e)):$("#formFilterGrafikSetor select[name=kelurahan]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kelurahan]").val("")}),$("#formFilterGrafikSetor input[name=tampilan]").on("change",function(){"per-daerah"==$(this).val()?$("#formFilterGrafikSetor select[name=kelurahan]").addClass("d-none"):$("#formFilterGrafikSetor select[name=kelurahan]").removeClass("d-none")});const filterGrafikSetor=async a=>{let e=new FormData(a.parentElement.parentElement.parentElement),t=`${e.get("year")} - `;penyetoranUrl=`${APIURL}/transaksi/grafikssampah?year=${e.get("year")}&tampilan=${e.get("tampilan")}`,typeTampilan=e.get("tampilan"),e.get("kelurahan")&&(t+=`${e.get("kelurahan")}, `,penyetoranUrl+=`&kelurahan=${e.get("kelurahan")}`),e.get("kecamatan")&&(t+=`${e.get("kecamatan")}, `,penyetoranUrl+=`&kecamatan=${e.get("kecamatan")}`),e.get("kota")&&(t+=`${e.get("kota")}, `,penyetoranUrl+=`&kota=${e.get("kota")}`),e.get("provinsi")&&(t+=`${e.get("provinsi")}`,penyetoranUrl+=`&provinsi=${e.get("provinsi")}`),""==e.get("provinsi")&&(t=`${e.get("year")} - semua wilayah`,penyetoranUrl=`${APIURL}/transaksi/grafikssampah?year=${e.get("year")}&tampilan=${e.get("tampilan")}`),$("#ket-filter-grafik-penyetoran").html(`${t} <small class="text-xxs">(${e.get("tampilan")})</small>`),getDataSetorSampah()},resetFilterGrafik=async a=>{$("#formFilterGrafikSetor select[name=year]").val((new Date).getFullYear()),$("#formFilterGrafikSetor select[name=orderby]").val("terbaru"),$("#formFilterGrafikSetor select[name=provinsi]").val(""),$("#formFilterGrafikSetor select[name=kota]").val(""),$("#formFilterGrafikSetor select[name=kota]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kecamatan]").val(""),$("#formFilterGrafikSetor select[name=kecamatan]").attr("disabled",!0),$("#formFilterGrafikSetor select[name=kelurahan]").val(""),$("#formFilterGrafikSetor select[name=kelurahan]").attr("disabled",!0),$("#formFilterGrafikSetor .form-check-input").prop("checked",!1),$("#formFilterGrafikSetor input#per-bulan").prop("checked",!0)};let chartGrafik="",typeTampilan="per-bulan",penyetoranUrl=`${APIURL}/transaksi/grafikssampah?year=${(new Date).getFullYear()}&tampilan=per-bulan`;const getDataSetorSampah=async()=>{$("#spinner-grafik-penyetoran").removeClass("d-none");let a=await httpRequestGet(penyetoranUrl);$("#spinner-grafik-penyetoran").addClass("d-none");let e="line",t=[""],r=[0];if(200===a.status){let l=a.data.data;if("per-daerah"==typeTampilan)e="bar",$("#chart-title").html(l.label),l.daerah.forEach(a=>{t.push(a[l.label]),r.push(a.jumlah_kg)});else{$("#chart-title").html("bulan");for(const a in l)t.push(a),r.push(l[a].totSampahMasuk)}}""!=chartGrafik&&chartGrafik.destroy();var l=document.getElementById("chart-grafik-penyetoran").getContext("2d");document.querySelector("#chart-grafik-penyetoran").style.width="100%",document.querySelector("#chart-grafik-penyetoran").style.height="300px",document.querySelector("#chart-grafik-penyetoran").style.maxHeight="300px";var n=l.createLinearGradient(0,230,0,50);n.addColorStop(1,"rgba(193,217,102,0.2)");var i=l.createLinearGradient(0,230,0,50);i.addColorStop(1,"rgba(193,217,102,0.2)");for(let a=t.length;a<10;a++)t.push(" ");"line"==e&&1==r.length&&(r=[],t.unshift("")),chartGrafik=new Chart(l,{type:e,data:{labels:t,datasets:[{label:"Kg",tension:.4,borderWidth:0,pointRadius:0,borderColor:"#c1d966",borderWidth:3,backgroundColor:n,fill:!0,data:r,maxBarThickness:6,minBarLength:6}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{grid:{drawBorder:!1,display:!0,drawOnChartArea:!0,drawTicks:!1,borderDash:[5,5]},ticks:{display:!0,padding:10,color:"#b2b9bf",beginAtZero:!0,font:{size:11,family:"Open Sans",style:"normal",lineHeight:2}}},x:{grid:{drawBorder:!1,display:!1,drawOnChartArea:!1,drawTicks:!1,borderDash:[5,5]},ticks:{display:!0,color:"#b2b9bf",padding:0,font:{size:11,family:"Open Sans",style:"normal",lineHeight:2}}}}}})};getDataSetorSampah();